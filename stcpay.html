<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STC Pay</title>

<style>
:root{
  --stc-green: linear-gradient(135deg,#1fd18b,#7ae582);
  --border:#e5e7eb;
  --text:#374151;
}

body{
  margin:0;
  background:#f3f4f6;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
}

/* ===== Main Card ===== */
.container{
  max-width:420px;
  margin:40px auto;
  background:#fff;
  border-radius:22px;
  padding:26px;
  box-shadow:0 20px 50px rgba(0,0,0,.1);

  /* ğŸ”´ Ø§Ù„Ø­Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø²ÙˆØ§ÙŠØ§ */
  overflow:hidden;
}

/* ===== Header ===== */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin:-26px;
  margin-bottom:24px;
  padding:26px;
  border-bottom:1px solid #f1f1f1;
  background:#fff;
}

.brand{
  display:flex;
  align-items:center;
  gap:12px;
}

.logo{
  width:48px;
  height:48px;
  border-radius:14px;
  background:var(--stc-green);
  display:flex;
  align-items:center;
  justify-content:center;
  color:#fff;
  font-weight:700;
}

.brand h2{
  margin:0;
  font-size:18px;
}

.merchant{
  font-size:13px;
  color:#555;
  line-height:1.4;
  text-align:left;
}

/* ===== Order Summary ===== */
.order-summary {
  background: #f8f9fa;
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 20px;
  border: 1px solid #e9ecef;
}

.order-summary h4 {
  margin: 0 0 12px 0;
  color: #2d3748;
  font-size: 16px;
}

.order-detail {
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
  font-size: 14px;
}

.order-detail.total {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 2px solid #e2e8f0;
  font-weight: 700;
  color: #1a202c;
  font-size: 18px;
}

/* ===== Form ===== */
.label{
  font-size:14px;
  margin-bottom:6px;
  color:var(--text);
}

input{
  width:100%;
  padding:15px;
  border-radius:12px;
  border:1px solid var(--border);
  font-size:16px;
  outline:none;
}

input:focus{
  border-color:#1fd18b;
}

/* ===== Buttons ===== */
button{
  width:100%;
  margin-top:22px;
  padding:16px;
  border:none;
  border-radius:14px;
  font-size:16px;
  font-weight:600;
  color:#fff;
  background:#d1d5db;
  cursor:not-allowed;
  transition:.3s;
}

button.active{
  background:var(--stc-green);
  cursor:pointer;
}

/* ===== Utility ===== */
.hidden{display:none;}
.center{text-align:center;}

.status{
  margin-top:25px;
  color:var(--text);
  font-size:15px;
}

/* ===== Success ===== */
.success h3{
  color:#1fd18b;
  font-size:22px;
  margin-bottom:10px;
}

/* ===== Redirect Message ===== */
.redirect-message {
  margin-top: 20px;
  padding: 12px;
  background: #edf2f7;
  border-radius: 8px;
  color: #4a5568;
  font-size: 13px;
  text-align: center;
}
</style>
</head>

<body>

<div class="container">

  <!-- Header -->
  <div class="header">
    <div class="brand">
      <div class="logo">STC</div>
      <h2>STC Pay</h2>
    </div>
    <div class="merchant">
      ØªØ¬Ø§Ø± Ø¨Ù„Ø³<br>
      Ù…Ø·Ø¹Ù… Ø¬Ùˆ ÙƒØ±Ø³Ø¨ÙŠ
    </div>
  </div>

  <!-- Order Summary -->
  <div id="orderSummary" class="order-summary">
    <h4>Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨</h4>
    <div id="orderDetails">
      <!-- Order details will be populated by JavaScript -->
    </div>
  </div>

  <!-- STEP 1: Phone -->
  <div id="step1">
    <div class="label">Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</div>
    <input
      type="tel"
      id="phone"
      placeholder="05XXXXXXXX"
      oninput="checkPhone()"
    >
    <button id="sendBtn" onclick="sendToStc()">ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ STC Pay</button>
  </div>

  <!-- STEP 2: Sending -->
  <div id="sending" class="hidden center">
    <div class="status">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ©â€¦</div>
  </div>

  <!-- STEP 3: OTP -->
  <div id="otpStep" class="hidden">
    <div class="label">Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ (4 Ø£Ø±Ù‚Ø§Ù…)</div>
    <input
      type="text"
      id="otp"
      maxlength="4"
      placeholder="â€¢â€¢â€¢â€¢"
      oninput="checkOtp()"
    >
    <button id="otpBtn" onclick="confirmOtp()">ØªØ£ÙƒÙŠØ¯</button>
  </div>

  <!-- STEP 4: Success -->
  <div id="success" class="hidden center success">
    <h3>âœ… ØªÙ… Ø§Ù„Ø¯ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­</h3>
    <p>Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ STC Pay</p>
    <p style="font-size:13px;color:#6b7280;">
      ØªØ¬Ø§Ø± Ø¨Ù„Ø³ â€“ Ù…Ø·Ø¹Ù… Ø¬Ùˆ ÙƒØ±Ø³Ø¨ÙŠ
    </p>
    <div class="redirect-message">
      Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ WhatsApp Ù…Ø¹ Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨...
    </div>
  </div>

</div>

<script>
// Get order details from URL parameters
const urlParams = new URLSearchParams(window.location.search);
const orderId = urlParams.get('orderId') || '1234';
const total = urlParams.get('total') || '0';
const items = urlParams.get('items') || '0';
const delivery = urlParams.get('delivery') || 'pickup';

// Display order summary
function displayOrderSummary() {
  const orderDetails = document.getElementById('orderDetails');
  const deliveryFee = delivery === 'delivery' ? 25 : 0;
  const subtotal = total - deliveryFee;
  
  orderDetails.innerHTML = `
    <div class="order-detail">
      <span>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµÙ†Ø§Ù:</span>
      <span>${items}</span>
    </div>
    <div class="order-detail">
      <span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ:</span>
      <span>${subtotal} Ø±ÙŠØ§Ù„</span>
    </div>
    ${delivery === 'delivery' ? `
    <div class="order-detail">
      <span>Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„:</span>
      <span>25 Ø±ÙŠØ§Ù„</span>
    </div>
    ` : ''}
    <div class="order-detail total">
      <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
      <span>${total} Ø±ÙŠØ§Ù„</span>
    </div>
  `;
}

// Auto-redirect back to WhatsApp after payment success
function redirectToWhatsApp() {
  setTimeout(() => {
    // Redirect back to WhatsApp with success parameters
    window.location.href = `./index.html?payment=success&orderId=${orderId}&source=stcpay`;
  }, 3000); // 3 seconds delay to show success message
}

function checkPhone(){
  const phone=document.getElementById("phone").value;
  const btn=document.getElementById("sendBtn");
  if(phone.length>=9){
    btn.classList.add("active");
    btn.disabled=false;
  }else{
    btn.classList.remove("active");
    btn.disabled=true;
  }
}

function sendToStc(){
  document.getElementById("step1").classList.add("hidden");
  document.getElementById("sending").classList.remove("hidden");

  // Ø§Ù†ØªÙ‚Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¥Ù„Ù‰ OTP Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
  setTimeout(()=>{
    document.getElementById("sending").classList.add("hidden");
    document.getElementById("otpStep").classList.remove("hidden");
  },2000);
}

function checkOtp(){
  const otp=document.getElementById("otp").value;
  const btn=document.getElementById("otpBtn");
  if(otp.length===4){
    btn.classList.add("active");
    btn.disabled=false;
  }else{
    btn.classList.remove("active");
    btn.disabled=true;
  }
}

function confirmOtp(){
  document.getElementById("otpStep").classList.add("hidden");
  document.getElementById("success").classList.remove("hidden");
  
  // Auto-redirect to WhatsApp after payment success
  redirectToWhatsApp();
}

// Initialize page
window.onload = function() {
  displayOrderSummary();
};
</script>

</body>
</html>
